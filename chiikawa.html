<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JIWUå‰ç‰©è²©å”®ï¼å¯¶å¯¶ç›®éŒ„</title>
  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />
  <style>
    /* === å…¨åŸŸä¸»é¡Œè‰²è¨­å®š === */
    :root { --theme-color: #d77485; }
    
    /* === bodyåŸºç¤æ¨£å¼ === */
    body {
      font-family: "Noto Sans TC", Arial, sans-serif;
      margin: 0;
      background: #f9f9f9;
      color: #333;
    }

    /* === é ‚éƒ¨é€šçŸ¥æ¬„æ¨£å¼ === */
    .top-bar {
      background: var(--theme-color);
      color: #fff;
      text-align: center;
      padding: 12px 10px;
      font-weight: 700;
      user-select: none;
      animation: bounce 1.2s ease-in-out infinite alternate;
      position: sticky;
      top: 0;
      z-index: 9999;
    }
    .top-bar a {
      color: #fff;
      text-decoration: none;
    }
    /* é ‚éƒ¨å½ˆè·³å‹•ç•«è¨­å®š */
    @keyframes bounce {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }
    
    /* === é é¢æ¨™é¡Œ === */
    h1 {
      text-align: center;
      margin: 20px 0 10px;
      font-weight: 700;
    }

    /* === å•†å“ç¨®é¡åˆ†éš”ç·š === */
    .type-divider {
      display: flex;
      align-items: center;
      margin: 14px 0 8px;
      color: #666;
      user-select: none;
      font-weight: 600;
      font-size: 0.95em;
    }
    .type-divider::before,
    .type-divider::after {
      content: "";
      flex: 1;
      border-top: 1px solid #ccc;
      margin: 0 10px;
    }

    /* === å•†å“å¡ç‰‡å®¹å™¨ï¼Œä½¿ç”¨ç¶²æ ¼è‡ªå‹•æ’ç‰ˆ === */
    .card-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 10px;
      padding: 0 10px 20px;
      justify-items: center;
    }

    /* === å–®å¼µå•†å“å¡ç‰‡æ¨£å¼ === */
    .card {
      border: 2px solid var(--theme-color);
      border-radius: 8px;
      background: #fff;
      width: 150px;
      box-sizing: border-box;
      text-align: center;
      padding: 8px 6px;
      user-select: none;
      cursor: default;
      transition: box-shadow 0.3s ease;
    }

    /* === å–®å¼µå•†å“å¡ç‰‡æ¨£å¼ === */
    .card:hover {
      box-shadow: 0 4px 10px rgba(215, 116, 133, 0.6);
    }

    /* å•†å“åœ–ç‰‡æ¨£å¼ï¼Œå›ºå®šé«˜åº¦ä¸”ç­‰æ¯”ç¸®æ”¾ */
    .card img {
      width: 100%;
      height: 120px;
      object-fit: contain;
      border-radius: 6px;
      user-select: none;
    }

    /* å•†å“åç¨±å­—é«”æ¨£å¼ */
    .card .name {
      font-weight: 700;
      margin: 8px 0 4px;
      font-size: 1em;
      color: #333;
    }

    /* å”®åƒ¹å­—é«”æ¨£å¼ */
    .card .price {
      color: var(--theme-color);
      font-weight: 600;
      font-size: 0.9em;
      margin-bottom: 4px;
    }

    /* è²¨æ³æ¨™ç±¤å­—é«”åŠé–“è· */
    .card .stock {
      font-size: 0.85em;
      color: #555;
      margin-bottom: 4px;
    }

    /* æ¡Œæ©Ÿä»¥ä¸Šå°ºå¯¸èª¿æ•´å¡ç‰‡å¯¬é«˜åŠæ¨™é¡Œå¤§å° */
    @media (min-width: 768px) {
      .card {
        width: 180px;
      }
      .card img {
        height: 140px;
      }
      .section-title {
        font-size: 1.3em;
      }
    }
  <script>
// === Google è©¦ç®—è¡¨è¨­å®š ===
// æŒ‡å®šè©¦ç®—è¡¨ ID å’Œå·¥ä½œè¡¨åç¨±
const SHEET_ID = "1iCEqgnGGa_TVVbx90xNWxDzwKtz94VfqF8IsXRvpKMY";
const SHEET_NAME = "ã¡ã„ã‹ã‚";
const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

// === è§’è‰²å°æ‡‰è¡¨ ===
// è§’è‰²æ¬„å¦‚æœåŒ…å«å°æ‡‰å­—ï¼Œå°±åˆ†é¡åˆ°è©²è§’è‰²
// åªæœ‰è§’è‰²æ¬„æœ‰ã€Œå…¶ã€æ‰åˆ†é¡åˆ°ã€Œå…¶ä»–è§’è‰²ã€
const roleMap = {
  "å‰ä¼Š": "å‰",
  "å°å…«": "å…«",
  "å…”å…”": "å…”",
  "å°æ¡ƒ": "æ¡ƒ",
  "å¸«å‚…": "çº",
  "æ —å­": "æ —",
  "ç…è–©": "ç…",
  "å¤æœ¬": "å¤",
  "å…¶ä»–è§’è‰²": "å…¶"
};

// === å•†å“ç¨®é¡å°æ‡‰è¡¨ ===
// ç”¨ã€Œç¨®é¡æ¬„ã€æˆ–ã€Œåç¨±æ¬„ã€çš„é—œéµå­—åˆ†é¡å•†å“
const typeMap = {
  "è²¼ç´™è† å¸¶": ["è²¼ç´™"],
  "æ–‡å…·ç£éµ": ["æ–‡å…·", "ç£éµ"],
  "ç«‹ç‰Œå¾½ç« ": ["ç«‹ç‰Œ", "å¾½ç« "],
  "é‘°åŒ™åœˆå¾¡å®ˆ": ["é‘°åŒ™åœˆ", "å¾¡å®ˆ"],
  "ç©å…·ç›²æŠ½": ["ç©å…·", "ç›²"],
  "æœé£¾åŒ…è¢‹": ["åŒ…åŒ…", "è¡£æœ", "é£¾å“"],
  "ç”Ÿæ´»å±…å®¶": ["3C", "å±…å®¶", "æ¯›å·¾"],
  "é¤å»šç”¨å“": ["é¤å»š"]
};

// === å–å¾— Google è©¦ç®—è¡¨è³‡æ–™ ===
fetch(url)
  .then(res => res.text()) // å–å¾—åŸå§‹æ–‡å­—
  .then(t => JSON.parse(t.substr(47).slice(0, -2))) // å»æ‰å¤šé¤˜å­—å…ƒå†è½‰ JSON
  .then(data => {
    const rows = data.table.rows.slice(1); // ç§»é™¤è¡¨é ­åˆ—

    // === å°‡æ¯åˆ—è³‡æ–™è½‰æ›ç‚ºå•†å“ç‰©ä»¶ ===
    const items = rows.map(row => {
      const c = row.c; // æ¬„ä½é™£åˆ—
      return {
        role: c[0]?.v || "",          // è§’è‰² (æ¬„ä½1)
        type: c[1]?.v || "",          // ç¨®é¡ (æ¬„ä½2)
        name: c[2]?.v || "",          // åç¨± (æ¬„ä½3)
        price: c[4]?.v || "",         // å”®åƒ¹ (æ¬„ä½5)
        stock: c[5]?.v || "",         // åº«å­˜ (æ¬„ä½6)
        nonStock: c[6]?.v || "",      // éç¾ (æ¬„ä½7)
        onShelf: c[7]?.v || "",       // ä¸Šæ¶ç‹€æ…‹ (æ¬„ä½8)
        acceptOrder: c[8]?.v || "",   // å—æ³¨å“æ¨™ç¤º (æ¬„ä½9)
        img: c[10]?.v || "",          // å•†å“åœ–ç‰‡ (æ¬„ä½11)
      };
    });

    // === åˆå§‹åŒ–è§’è‰²åˆ†çµ„ ===
    const grouped = {};
    Object.keys(roleMap).forEach(r => grouped[r] = []);

    // === å°‡å•†å“ä¾è§’è‰²åˆ†é¡ ===
    items.forEach(item => {
      if (item.onShelf.toLowerCase() === "x") return; // ä¸Šæ¶æ¬„ç‚ºã€Œxã€â†’ ä¸é¡¯ç¤º

      // æ‰¾å‡ºå•†å“è§’è‰²
      let matchedRole = null;
      for (const [roleName, keyword] of Object.entries(roleMap)) {
        if (item.role.includes(keyword)) {
          matchedRole = roleName;
          break;
        }
      }

      if (matchedRole) {
        grouped[matchedRole].push(item); // åˆ†åˆ°å°æ‡‰è§’è‰²
      }
      // å¦‚æœè§’è‰²æ¬„å®Œå…¨å°ä¸åˆ° â†’ ä¸é¡¯ç¤º
    });

    // === å–å¾—é é¢ä¸»å…§å®¹å®¹å™¨ ===
    const content = document.getElementById("content");
    content.innerHTML = ""; // æ¸…ç©ºã€Œè³‡æ–™è¼‰å…¥ä¸­...ã€

    // === ä¾è§’è‰²ç”Ÿæˆå…§å®¹å€å¡Š ===
    for (const [roleName, items] of Object.entries(grouped)) {
      if (items.length === 0) continue; // è©²è§’è‰²æ²’å•†å“è·³é

      // ğŸŒ¸ è§’è‰²å€å¡Šæ¨™é¡Œ
      const sectionTitle = document.createElement("div");
      sectionTitle.className = "section-title";
      sectionTitle.textContent = roleName;
      content.appendChild(sectionTitle);

      // === å°‡è§’è‰²ä¸‹çš„å•†å“ä¾ç¨®é¡åˆ†é¡ ===
      const typeGroups = {};
      Object.keys(typeMap).forEach(typeName => typeGroups[typeName] = []);
      typeGroups["å…¶ä»–"] = [];

      items.forEach(item => {
        let foundType = false;
        for (const [typeName, keywords] of Object.entries(typeMap)) {
          if (keywords.some(kw => item.type.includes(kw) || item.name.includes(kw))) {
            typeGroups[typeName].push(item);
            foundType = true;
            break;
          }
        }
        if (!foundType) typeGroups["å…¶ä»–"].push(item);
      });

      // === ä¾ç¨®é¡é¡¯ç¤ºå•†å“å¡ ===
      for (const [typeName, typeItems] of Object.entries(typeGroups)) {
        if (typeItems.length === 0) continue; // è©²ç¨®é¡æ²’å•†å“è·³é

        // ğŸŒ¸ ç¨®é¡åˆ†éš”æ¨™é¡Œ
        const divider = document.createElement("div");
        divider.className = "type-divider";
        divider.textContent = typeName;
        content.appendChild(divider);

        // ğŸŒ¸ å•†å“å¡å®¹å™¨
        const cardContainer = document.createElement("div");
        cardContainer.className = "card-container";

        // === ç”Ÿæˆæ¯å€‹å•†å“å¡ ===
        typeItems.forEach(item => {
          // ğŸ”¥ åˆ¤æ–·è²¨æ³ä¸¦è¨­å®šé¡è‰²æ¨£å¼
          let stockHtml = "";
          if (item.acceptOrder.toLowerCase() === "v") {
            stockHtml = `<span style="background:#74BDCB;color:#ffffff;padding:2px 8px;border-radius:12px;">å—æ³¨å“</span>`;
          } else if (item.stock && parseInt(item.stock) > 0) {
            stockHtml = `<span style="background:#FFF4BD;color:#333333;padding:2px 8px;border-radius:12px;">ç¾è²¨</span>`;
          } else if ((!item.stock || parseInt(item.stock) === 0) && (!item.nonStock || item.nonStock.trim() === "")) {
            stockHtml = `<span style="background:#D4BBDD;color:#333333;padding:2px 8px;border-radius:12px;">éœ€é è¨‚</span>`;
          } else if ((!item.stock || parseInt(item.stock) === 0) && item.nonStock.trim() !== "") {
            stockHtml = `<span style="background:#5885AF;color:#ffffff;padding:2px 8px;border-radius:12px;">æ­é£›æ©Ÿä¸­</span>`;
          } else {
            stockHtml = `<span style="background:#E7F2F8;color:#333333;padding:2px 8px;border-radius:12px;">é»è²¨ä¸­</span>`;
          }

          // ğŸŒ¸ å»ºç«‹å•†å“å¡
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <img src="${item.img || 'https://i.postimg.cc/bv5xRs04/image.png'}" alt="${item.name}">
            <div class="stock">${stockHtml}</div>
            <div class="name">${item.name}</div>
            <div class="price">${item.price}</div>
          `;
          cardContainer.appendChild(card);
        });

        content.appendChild(cardContainer);
      }
    }
  })
  .catch(e => {
    // === è³‡æ–™è¼‰å…¥å¤±æ•—æç¤º ===
    document.getElementById("content").innerHTML = "è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚";
    console.error(e);
  });
</script>
</body>
</html>
