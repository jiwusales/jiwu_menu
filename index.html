<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JIWUå‰ç‰©è²©å”®</title>

  <meta property="og:title" content="JIWUå‰ç‰©è²©å”®" />
  <meta property="og:description" content="JIWUå¯¶å¯¶ç›®éŒ„é€™é‚Šçœ‹ Ù©(à¹‘Ë†OË†à¹‘)Û¶ æ­¡è¿åƒè§€é¸è³¼âºâŠ¹Ëš.â‹†" />
  <meta property="og:image" content="https://i.postimg.cc/0QMPqY9n/image.png" />
  <meta property="og:url" content="https://jiwusales.github.io/jiwu_menu/" />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />

  <link rel="apple-touch-icon" href="https://i.postimg.cc/VN7WjCdL/icon026.png" />
  <meta name="theme-color" content="#dac7b7" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  
  <style>
    /* é é¢åŸºç¤æ¨£å¼ */
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      color: #333333;
      background: #fff;
    }

    /* æŒ‰éˆ•æ¨£å¼ (é‡æ–°æ•´ç†) */
    .control-btn {
      position: fixed;
      top: 20px;
      left: 10px;
      width: 45px;
      height: 45px;
      border: none;
      border-radius: 50%;
      background-color: #E7D4C0;
      opacity: 0.5;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.25);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
      transition: opacity 0.2s, transform 0.2s;
      padding: 0;
    }
    .control-btn img {
      width: 60%;
      height: 60%;
    }

    .logo-container {
      text-align: center;
      margin: 20px 0;
    }
    .logo-container img {
      width: 160px; 
      height: auto;
    }

    /* ğŸš€ æ–°ç‰ˆè¼ªæ’­å®¹å™¨ï¼šæ©«å‘æ²å‹•ä½ˆå±€ */
    .carousel-wrapper {
      width: 100%;
      overflow-x: auto;
      scroll-snap-type: x mandatory; /* æ²å‹•å¸é™„æ„Ÿ */
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none; /* éš±è—æ²è»¸ */
      margin-bottom: 5px;
    }
    .carousel-wrapper::-webkit-scrollbar {
      display: none; /* éš±è—æ²è»¸ */
    }

    .carousel {
      display: flex;
      padding: 0 12px;
      gap: 10px; /* åœ–ç‰‡é–“è· */
      width: max-content;
    }

    /* åœ–ç‰‡é …ç›®çš„å¯¬åº¦èˆ‡æ¯”ä¾‹èª¿æ•´ (é‡å° 1080x1350) */
    .carousel a {
      display: block;
      width: 31vw; /* æ‰‹æ©Ÿè¢å¹•é¡¯ç¤ºç´„ 3.2 å¼µåœ– */
      max-width: 180px; /* é¿å…æ¡Œæ©Ÿç‰ˆå¤ªå¤§ */
      flex-shrink: 0;
      scroll-snap-align: start;
      text-decoration: none;
    }

    .carousel img {
      width: 100%;
      height: auto;
      aspect-ratio: 1080 / 1350; /* é–å®šæ¯”ä¾‹ */
      object-fit: cover;
      border-radius: 10px;
      display: block;
    }

    #carousel-caption {
      text-align: center;
      color: #aaa;
      font-size: 11px;
      margin-bottom: 25px;
      letter-spacing: 1px;
    }

    /* åˆ†éš”å¡Š */
    .section-divider {
      width: 100%;
      padding: 12px 0;
      font-weight: bold;
      font-size: 1.2em;
      text-align: center;
    }
    .divider-1, .divider-2 {
      background-color: #dac7b7;
      color: #ffffff;
    }
    .divider-3 {
      background-color: #F9F6F0;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
      padding: 15px 0;
    }

    /* è§’è‰²æŒ‰éˆ•æ¨£å¼ */
    .role-buttons {
      max-width: 960px;
      margin: 20px auto 40px auto;
      padding: 0 10px;
    }
    .role-buttons .row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
      margin-bottom: 10px;
    }
    .role-buttons .item {
      width: 80px;
      text-align: center;
    }
    .role-buttons .item img {
      width: 100%;
      border-radius: 6px;
      transition: transform 0.3s;
    }
    .role-buttons .item:hover img {
      transform: scale(1.1);
    }
    .role-buttons .item span {
      display: block;
      font-size: 0.85em;
      color: #333;
    }
    .role-buttons.japan-ip .item {
      width: 120px;
    }
    .separator {
      border-top: 1px solid #ccc;
      margin: 20px 0;
    }
    .social-links a img {
      width: 40px;
    }
    footer {
      text-align: center;
      padding: 20px 10px;
      font-size: 1em;
      color: #333333;
    }
  </style>
</head>
<body>

<div class="logo-container">
  <img src="https://i.postimg.cc/CLBFxHs3/logo-banner.png" alt="LOGO" />
</div>

<div class="carousel-wrapper">
  <div class="carousel" id="carousel-inner">
    </div>
</div>
<div id="carousel-caption">å·¦å³æ»‘å‹•æŸ¥çœ‹æ´»å‹• â”</div>

<div class="section-divider divider-1">JIWUå¯¶å¯¶ç›®éŒ„ á¯“â˜… å‰ä¼Šå¡å“‡</div>

<div class="role-buttons">
  <div class="row">
    <div class="item"><a href="CHWBM.html?role=å‰ä¼Š"><img src="https://i.postimg.cc/ncqjRJ9S/icon001.png" /><span>å‰ä¼Š</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å°å…«"><img src="https://i.postimg.cc/Ss5kqJ3L/icon002.png" /><span>å°å…«</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å…”å…”"><img src="https://i.postimg.cc/QdbBDJbp/icon003.png" /><span>å…”å…”</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å°æ¡ƒ"><img src="https://i.postimg.cc/3NmRcXN0/icon004.png" /><span>å°æ¡ƒ</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å¸«å‚…"><img src="https://i.postimg.cc/y8vNtY1j/icon005.png" /><span>å¸«å‚…</span></a></div>
    <div class="item"><a href="CHWBM.html?role=æ —å­"><img src="https://i.postimg.cc/mD0kjXLG/icon006.png" /><span>æ —å­</span></a></div>
    <div class="item"><a href="CHWBM.html?role=ç…è–©"><img src="https://i.postimg.cc/Ghn9s5gF/icon007.png" /><span>ç…è–©</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å¤æœ¬"><img src="https://i.postimg.cc/2jsL76yB/icon008.png" /><span>å¤æœ¬</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å…¶ä»–è§’è‰²"><img src="https://i.postimg.cc/PqVPpf0J/icon009.png" /><span>å…¶ä»–è§’è‰²</span></a></div>
  </div>
  <div class="separator"></div>
  <div class="row">
    <div class="item"><a href="CHWKD.html?type=è²¼ç´™è† å¸¶"><img src="https://i.postimg.cc/bYtsrhgY/icon011.png" /><span>è²¼ç´™è† å¸¶</span></a></div>
    <div class="item"><a href="CHWKD.html?type=æ–‡å…·ç£éµ"><img src="https://i.postimg.cc/NLvt9Zg5/icon012.png" /><span>æ–‡å…·ç£éµ</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç«‹ç‰Œå¾½ç« "><img src="https://i.postimg.cc/c1g83YxS/icon013.png" /><span>ç«‹ç‰Œå¾½ç« </span></a></div>
    <div class="item"><a href="CHWKD.html?type=é‘°åŒ™åœˆå¾¡å®ˆ"><img src="https://i.postimg.cc/GptpCw9C/icon014.png" /><span>é‘°åŒ™åœˆå¾¡å®ˆ</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç©å…·ç›²æŠ½"><img src="https://i.postimg.cc/ydWswFQY/icon015.png" /><span>ç©å…·ç›²æŠ½</span></a></div>
    <div class="item"><a href="CHWKD.html?type=æœé£¾åŒ…è¢‹"><img src="https://i.postimg.cc/rwcd7PSV/icon016.png" /><span>æœé£¾åŒ…è¢‹</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç”Ÿæ´»å±…å®¶"><img src="https://i.postimg.cc/1z383VCb/icon017.png" /><span>ç”Ÿæ´»å±…å®¶</span></a></div>
    <div class="item"><a href="CHWKD.html?type=é¤å»šç”¨å“"><img src="https://i.postimg.cc/g2YJg6Wr/icon018.png" /><span>é¤å»šç”¨å“</span></a></div>
  </div>
</div>

<div class="section-divider divider-2">JIWUå¯¶å¯¶ç›®éŒ„ á¯“â˜… æ—¥æœ¬IPè§’è‰²</div>

<div class="role-buttons japan-ip">
  <div class="row">
    <div class="item"><a href="NGNBM.html"><img src="https://i.postimg.cc/hP8v81NH/icon019.png" /><span>è‡ªå˜²ç†Š</span></a></div>
    <div class="item"><a href="WBTBM.html"><img src="https://i.postimg.cc/sXB1pdRc/icon020.png" /><span>å°ç™½è™èˆ‡é»‘è™è¦</span></a></div>
  </div>
</div>

<div class="section-divider divider-3 social-links">
  <a href="https://www.facebook.com/jiwusales" target="_blank" rel="noopener noreferrer"><img src="https://i.postimg.cc/9fkQX8qq/icon021.png" alt="Facebook" /></a>
  <a href="https://www.instagram.com/jiwu_sales/" target="_blank" rel="noopener noreferrer"><img src="https://i.postimg.cc/Hx7srwQv/icon022.png" alt="Instagram" /></a>
  <a href="https://www.threads.com/@jiwu_sales" target="_blank" rel="noopener noreferrer"><img src="https://i.postimg.cc/brcYkZgy/icon023.png" alt="Threads" /></a>
  <a href="https://lin.ee/X6FUFI9" target="_blank" rel="noopener noreferrer"><img src="https://i.postimg.cc/KjPGNmpn/icon024.png" alt="LINE" /></a>
</div>

<footer>å°ä¸­æœ‹æœ‹æ­¡è¿è‡ªå– Ë– à£ª â˜… (à¸‡Ë™âˆ‡Ë™)à¸§ å®˜æ–¹LINEç´„ç´„</footer>

<button id="refreshBtn" class="control-btn" onclick="location.reload()" title="é‡æ–°æ•´ç†">
  <img src="https://i.postimg.cc/gkpnr8RJ/re.png" alt="Refresh" />
</button>

<script>
(async function() {
  const carouselInner = document.getElementById('carousel-inner');
  const caption = document.getElementById('carousel-caption');

  const SHEET_ID = '12_TmFFXMcAAUYaUSFDTSoLIDSZ6L20XPEUIwvIIUPTM';
  const SHEET_NAME = 'è¼ªæ’­';
  const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

  async function fetchSheetData() {
    const res = await fetch(API_URL);
    const text = await res.text();
    const json = JSON.parse(text.match(/(?<=google\.visualization\.Query\.setResponse\().*(?=\);)/s)[0]);
    return json.table.rows;
  }

  // ğŸš€ å»ºç«‹æ²å‹•å¼è¼ªæ’­å…§å®¹
  function renderCarousel(rows) {
    carouselInner.innerHTML = '';
    let hasImage = false;

    rows.forEach(row => {
      const onShelf = row.c[0]?.v?.toString().trim();
      if (onShelf?.toLowerCase() === 'x') return;

      const imgUrl = row.c[1]?.v;
      const text = row.c[2]?.v || '';

      if (imgUrl) {
        hasImage = true;
        const a = document.createElement('a');
        a.href = 'https://lin.ee/X6FUFI9';
        a.target = '_blank';
        a.rel = 'noopener noreferrer';

        const img = document.createElement('img');
        img.src = imgUrl;
        img.alt = text;
        
        a.appendChild(img);
        carouselInner.appendChild(a);
      }
    });

    if (!hasImage) caption.textContent = 'æš«ç„¡æ´»å‹•åœ–ç‰‡';
  }

  // ğŸ› ï¸ æ•´åˆç¬¬ä¸€éƒ¨åˆ†çš„è©¦ç®—è¡¨ç´¢å¼•é‚è¼¯ (ä¾›ç›®éŒ„é ä½¿ç”¨ä¹‹é‚è¼¯åƒè€ƒ)
  // æ­¤è™•åƒ…ç‚ºé¦–é è¼ªæ’­è¼‰å…¥
  async function init() {
    try {
      const rows = await fetchSheetData();
      renderCarousel(rows.slice(1));
    } catch (e) {
      console.error('è¼ªæ’­è¼‰å…¥å¤±æ•—', e);
      caption.textContent = 'è³‡æ–™è¼‰å…¥å¤±æ•—';
    }
  }

  init();
  // æ¯ 60 ç§’æ›´æ–°ä¸€æ¬¡èƒŒæ™¯è³‡æ–™
  setInterval(init, 60000);
})();
</script>
</body>
</html>
