<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JIWUå‰ç‰©è²©å”®</title>

  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />
  <link rel="apple-touch-icon" href="https://i.postimg.cc/VN7WjCdL/icon026.png" />
  <meta name="theme-color" content="#dac7b7" />
  
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      color: #333333;
      background: #fff;
    }

    /* ğŸš€ é—œéµä¿®æ”¹ï¼šç§»é™¤æ‰€æœ‰é€£çµåº•ç·šä¸¦å–æ¶ˆé»æ“Šé«˜äº® */
    a {
      text-decoration: none !important;
      -webkit-tap-highlight-color: transparent;
    }

    /* é‡æ–°æ•´ç†æŒ‰éˆ• */
    .control-btn {
      position: fixed;
      top: 20px;
      left: 10px;
      width: 45px;
      height: 45px;
      border: none;
      border-radius: 50%;
      background-color: #E7D4C0;
      opacity: 0.5;
      box-shadow: 0 0 6px rgba(0, 0, 0, 0.25);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .control-btn img { width: 60%; height: 60%; }

    .logo-container { text-align: center; margin: 20px 0; }
    .logo-container img { width: 160px; height: auto; }

    /* æœ€æ–°é–‹åœ˜æ¨™é¡Œç½®ä¸­ */
    .section-title {
      text-align: center;
      margin: 15px auto 20px auto;
      font-weight: bold;
      font-size: 1.2em;
      color: #5d4a3a;
      letter-spacing: 2px;
    }

    /* è¼ªæ’­å®¹å™¨ */
    .carousel-wrapper {
      width: 100%;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
      cursor: grab;
      user-select: none;
      scrollbar-width: none;
    }
    .carousel-wrapper::-webkit-scrollbar { display: none; }
    .carousel-wrapper:active { cursor: grabbing; }

    .carousel {
      display: flex;
      padding: 0 15px;
      gap: 12px;
      width: max-content;
    }

    .carousel a {
      display: block;
      width: 31vw; 
      max-width: 180px; 
      flex-shrink: 0;
      scroll-snap-align: center;
      text-align: center;
    }

    .carousel img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 10px;
      pointer-events: none;
      margin-bottom: 8px;
    }

    /* åœ–ç‰‡ä¸‹æ–¹èªªæ˜æ–‡å­—æ¨£å¼ */
    .item-caption {
      font-size: 11px;
      color: #666;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      min-height: 28px;
      text-decoration: none; /* å†æ¬¡ç¢ºä¿ç„¡åº•ç·š */
    }

    /* åˆ†é é»é»æ¨£å¼ */
    .carousel-dots {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin: 15px 0 35px 0;
    }
    .dot {
      width: 7px;
      height: 7px;
      background-color: #eee;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .dot.active {
      background-color: #dac7b7;
      transform: scale(1.3);
    }

    /* å…¶é¤˜å€å¡Šæ¨£å¼ */
    .section-divider { width: 100%; padding: 12px 0; font-weight: bold; font-size: 1.2em; text-align: center; }
    .divider-1, .divider-2 { background-color: #dac7b7; color: #ffffff; }
    .divider-3 { background-color: #F9F6F0; display: flex; justify-content: center; align-items: center; flex-wrap: wrap; gap: 20px; padding: 15px 0; }
    
    .role-buttons { max-width: 960px; margin: 20px auto 40px auto; padding: 0 10px; }
    .role-buttons .row { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-bottom: 10px; }
    .role-buttons .item { width: 80px; text-align: center; }
    
    /* ç¢ºä¿æŒ‰éˆ•å…§çš„é€£çµæ²’æœ‰åº•ç·š */
    .role-buttons .item a {
      display: block;
      text-decoration: none !important;
    }
    
    .role-buttons .item img { width: 100%; border-radius: 6px; transition: transform 0.3s; }
    .role-buttons .item span { display: block; font-size: 0.85em; color: #333; margin-top: 3px; }
    .role-buttons.japan-ip .item { width: 120px; }
    .separator { border-top: 1px solid #ccc; margin: 20px 0; }
    .social-links a img { width: 40px; }
    footer { text-align: center; padding: 20px 10px; font-size: 1em; color: #333333; }
  </style>
</head>
<body>

<div class="logo-container">
  <img src="https://i.postimg.cc/CLBFxHs3/logo-banner.png" alt="LOGO" />
</div>

<div class="section-title">æœ€æ–°é–‹åœ˜</div>

<div class="carousel-wrapper" id="scroll-wrapper">
  <div class="carousel" id="carousel-inner"></div>
</div>

<div class="carousel-dots" id="carousel-dots"></div>

<div class="section-divider divider-1">JIWUå¯¶å¯¶ç›®éŒ„ á¯“â˜… å‰ä¼Šå¡å“‡</div>

<div class="role-buttons">
  <div class="row">
    <div class="item"><a href="CHWBM.html?role=å‰ä¼Š"><img src="https://i.postimg.cc/ncqjRJ9S/icon001.png" /><span>å‰ä¼Š</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å°å…«"><img src="https://i.postimg.cc/Ss5kqJ3L/icon002.png" /><span>å°å…«</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å…”å…”"><img src="https://i.postimg.cc/QdbBDJbp/icon003.png" /><span>å…”å…”</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å°æ¡ƒ"><img src="https://i.postimg.cc/3NmRcXN0/icon004.png" /><span>å°æ¡ƒ</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å¸«å‚…"><img src="https://i.postimg.cc/y8vNtY1j/icon005.png" /><span>å¸«å‚…</span></a></div>
    <div class="item"><a href="CHWBM.html?role=æ —å­"><img src="https://i.postimg.cc/mD0kjXLG/icon006.png" /><span>æ —å­</span></a></div>
    <div class="item"><a href="CHWBM.html?role=ç…è–©"><img src="https://i.postimg.cc/Ghn9s5gF/icon007.png" /><span>ç…è–©</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å¤æœ¬"><img src="https://i.postimg.cc/2jsL76yB/icon008.png" /><span>å¤æœ¬</span></a></div>
    <div class="item"><a href="CHWBM.html?role=å…¶ä»–è§’è‰²"><img src="https://i.postimg.cc/PqVPpf0J/icon009.png" /><span>å…¶ä»–è§’è‰²</span></a></div>
  </div>
  <div class="separator"></div>
  <div class="row">
    <div class="item"><a href="CHWKD.html?type=è²¼ç´™è† å¸¶"><img src="https://i.postimg.cc/bYtsrhgY/icon011.png" /><span>è²¼ç´™è† å¸¶</span></a></div>
    <div class="item"><a href="CHWKD.html?type=æ–‡å…·ç£éµ"><img src="https://i.postimg.cc/NLvt9Zg5/icon012.png" /><span>æ–‡å…·ç£éµ</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç«‹ç‰Œå¾½ç« "><img src="https://i.postimg.cc/c1g83YxS/icon013.png" /><span>ç«‹ç‰Œå¾½ç« </span></a></div>
    <div class="item"><a href="CHWKD.html?type=é‘°åŒ™åœˆå¾¡å®ˆ"><img src="https://i.postimg.cc/GptpCw9C/icon014.png" /><span>é‘°åŒ™åœˆå¾¡å®ˆ</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç©å…·ç›²æŠ½"><img src="https://i.postimg.cc/ydWswFQY/icon015.png" /><span>ç©å…·ç›²æŠ½</span></a></div>
    <div class="item"><a href="CHWKD.html?type=æœé£¾åŒ…è¢‹"><img src="https://i.postimg.cc/rwcd7PSV/icon016.png" /><span>æœé£¾åŒ…è¢‹</span></a></div>
    <div class="item"><a href="CHWKD.html?type=ç”Ÿæ´»å±…å®¶"><img src="https://i.postimg.cc/1z383VCb/icon017.png" /><span>ç”Ÿæ´»å±…å®¶</span></a></div>
    <div class="item"><a href="CHWKD.html?type=é¤å»šç”¨å“"><img src="https://i.postimg.cc/g2YJg6Wr/icon018.png" /><span>é¤å»šç”¨å“</span></a></div>
  </div>
</div>

<div class="section-divider divider-2">JIWUå¯¶å¯¶ç›®éŒ„ á¯“â˜… æ—¥æœ¬IPè§’è‰²</div>

<div class="role-buttons japan-ip">
  <div class="row">
    <div class="item"><a href="NGNBM.html"><img src="https://i.postimg.cc/hP8v81NH/icon019.png" /><span>è‡ªå˜²ç†Š</span></a></div>
    <div class="item"><a href="WBTBM.html"><img src="https://i.postimg.cc/sXB1pdRc/icon020.png" /><span>å°ç™½è™èˆ‡é»‘è™è¦</span></a></div>
  </div>
</div>

<div class="section-divider divider-3 social-links">
  <a href="https://www.facebook.com/jiwusales" target="_blank"><img src="https://i.postimg.cc/9fkQX8qq/icon021.png" /></a>
  <a href="https://www.instagram.com/jiwu_sales/" target="_blank"><img src="https://i.postimg.cc/Hx7srwQv/icon022.png" /></a>
  <a href="https://www.threads.com/@jiwu_sales" target="_blank"><img src="https://i.postimg.cc/brcYkZgy/icon023.png" /></a>
  <a href="https://lin.ee/X6FUFI9" target="_blank"><img src="https://i.postimg.cc/KjPGNmpn/icon024.png" /></a>
</div>

<footer>å°ä¸­æœ‹æœ‹æ­¡è¿è‡ªå– Ë– à£ª â˜… (à¸‡Ë™âˆ‡Ë™)à¸§ å®˜æ–¹LINEç´„ç´„</footer>

<button id="refreshBtn" class="control-btn" onclick="location.reload()" title="é‡æ–°æ•´ç†">
  <img src="https://i.postimg.cc/gkpnr8RJ/re.png" />
</button>

<script>
(async function() {
  const wrapper = document.getElementById('scroll-wrapper');
  const inner = document.getElementById('carousel-inner');
  const dotsContainer = document.getElementById('carousel-dots');

  const SHEET_ID = '12_TmFFXMcAAUYaUSFDTSoLIDSZ6L20XPEUIwvIIUPTM';
  const SHEET_NAME = 'è¼ªæ’­';
  const API_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(SHEET_NAME)}`;

  async function fetchSheetData() {
    const res = await fetch(API_URL);
    const text = await res.text();
    const json = JSON.parse(text.match(/(?<=google\.visualization\.Query\.setResponse\().*(?=\);)/s)[0]);
    return json.table.rows;
  }

  function renderCarousel(rows) {
    inner.innerHTML = '';
    dotsContainer.innerHTML = '';
    let count = 0;

    rows.forEach((row) => {
      const onShelf = row.c[0]?.v?.toString().trim();
      if (onShelf?.toLowerCase() === 'x') return;
      
      const imgUrl = row.c[1]?.v;
      const captionText = row.c[2]?.v || ""; 

      if (imgUrl) {
        const a = document.createElement('a');
        a.href = 'https://lin.ee/X6FUFI9';
        a.target = '_blank';
        
        const img = document.createElement('img');
        img.src = imgUrl;
        
        const cap = document.createElement('div');
        cap.classList.add('item-caption');
        cap.textContent = captionText;

        a.appendChild(img);
        a.appendChild(cap);
        inner.appendChild(a);

        const dot = document.createElement('div');
        dot.classList.add('dot');
        if (count === 0) dot.classList.add('active');
        dot.addEventListener('click', () => {
          const scrollTarget = a.offsetLeft - (wrapper.offsetWidth / 2) + (a.offsetWidth / 2);
          wrapper.scrollTo({ left: scrollTarget, behavior: 'smooth' });
        });
        dotsContainer.appendChild(dot);
        
        count++;
      }
    });
  }

  wrapper.addEventListener('scroll', () => {
    const items = inner.querySelectorAll('a');
    const dots = dotsContainer.querySelectorAll('.dot');
    let activeIndex = 0;
    let minDiff = Infinity;

    items.forEach((item, i) => {
      const centerOfItem = item.offsetLeft + item.offsetWidth / 2;
      const centerOfWrapper = wrapper.scrollLeft + wrapper.offsetWidth / 2;
      const diff = Math.abs(centerOfItem - centerOfWrapper);
      if (diff < minDiff) {
        minDiff = diff;
        activeIndex = i;
      }
    });

    dots.forEach((dot, i) => {
      dot.classList.toggle('active', i === activeIndex);
    });
  });

  function enableDrag(el) {
    let isDown = false, startX, scrollLeft;
    el.addEventListener('mousedown', (e) => {
      isDown = true;
      startX = e.pageX - el.offsetLeft;
      scrollLeft = el.scrollLeft;
      el.style.scrollSnapType = 'none';
    });
    el.addEventListener('mouseleave', () => { isDown = false; el.style.scrollSnapType = 'x mandatory'; });
    el.addEventListener('mouseup', () => { isDown = false; el.style.scrollSnapType = 'x mandatory'; });
    el.addEventListener('mousemove', (e) => {
      if (!isDown) return;
      e.preventDefault();
      const x = e.pageX - el.offsetLeft;
      const walk = (x - startX) * 2;
      el.scrollLeft = scrollLeft - walk;
    });
  }

  async function init() {
    try {
      const rows = await fetchSheetData();
      renderCarousel(rows.slice(1));
      enableDrag(wrapper);
    } catch (e) { console.error('è¼‰å…¥å¤±æ•—', e); }
  }

  init();
  setInterval(init, 60000);
})();
</script>
</body>
</html>
