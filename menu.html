<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JIWU吉物寶寶目錄</title>
  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />
  <style>
    :root {
      --color-吉伊: #d77485;
      --color-小八: #6293b8;
      --color-兔兔: #f9be3c;
      --color-小桃: #838BC2;
      --color-師傅: #CCAFA5;
      --color-栗子: #94C973;
      --color-獅薩: #FBAA60;
      --color-古本: #eb9e97;
      --color-其他角色: #45818e;
      --color-貼紙膠帶: #F8C0C8;
      --color-文具磁鐵: #BAD3E4;
      --color-立牌徽章: #d5a6bd;
      --color-鑰匙圈御守: #7E9DC2;
      --color-玩具盲抽: #90ADC6;
      --color-服飾包袋: #b4a7d6;
      --color-生活居家: #98D7C2;
      --color-餐廚用品: #F1A17E;
      --color-仙境: #985859;
      --color-ナガノ: #68aad6;
      --color-小白虎黑虎蝦: #4f5474;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
    }

    /* 🔥 頂部公告區 */
    .top-bar {
      width: 100%;
      background-color: var(--role-color, #dac7b7);
      color: #fff;
      text-align: center;
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 999;
      font-size: 18px;
      font-weight: bold;
      animation: bounce 1.5s infinite;
    }
    .top-bar a {
      color: #fff;
      text-decoration: none;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* 🔥 分類分隔線 */
    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0 10px;
    }
    .divider::before,
    .divider::after {
      content: "";
      flex: 1;
      border-top: 1px solid #999;
    }
    .divider span {
      margin: 0 10px;
      font-weight: bold;
      font-size: 18px;
    }

    /* 🔥 商品卡容器 */
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 0 10px;
    }

    /* 🔥 單一商品卡 */
    .card {
      border: 2px solid #ccc;
      border-radius: 8px;
      width: calc(25% - 10px);
      min-width: 150px;
      background: #fff;
      box-sizing: border-box;
      text-align: center;
      transition: transform 0.3s, border-color 0.3s;
    }
    .card:hover {
      transform: scale(1.05);
    }
    .card img {
      width: 100%;
      height: auto;
      border-bottom: 1px solid #eee;
    }
    .card .name {
      font-size: 16px;
      font-weight: bold;
      margin: 5px 0;
    }
    .card .price {
      color: #666;
      margin-bottom: 8px;
    }
    .card .stock {
      font-size: 12px;
      color: #999;
      margin-bottom: 8px;
    }

    @media (max-width: 768px) {
      .card {
        width: calc(50% - 10px);
      }
    }
    @media (max-width: 480px) {
      .card {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- 🔥 頂部公告 -->
  <div class="top-bar">
    <a href="https://lin.ee/X6FUFI9" target="_blank">訂購這邊找花花 (৹˙꒳​˙ฅ)</a>
  </div>

  <!-- 🔥 內容容器 -->
  <div id="content"></div>

  <script>
    const SHEET_ID = "1iCEqgnGGa_TVVbx90xNWxDzwKtz94VfqF8IsXRvpKMY";
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

    const colors = {
      "吉伊": "--color-吉伊",
      "小八": "--color-小八",
      "兔兔": "--color-兔兔",
      "小桃": "--color-小桃",
      "師傅": "--color-師傅",
      "栗子": "--color-栗子",
      "獅薩": "--color-獅薩",
      "古本": "--color-古本",
      "其他角色": "--color-其他角色",
      "仙境": "--color-仙境",
      "貼紙膠帶": "--color-貼紙膠帶",
      "文具磁鐵": "--color-文具磁鐵",
      "立牌徽章": "--color-立牌徽章",
      "鑰匙圈御守": "--color-鑰匙圈御守",
      "玩具盲抽": "--color-玩具盲抽",
      "服飾包袋": "--color-服飾包袋",
      "生活居家": "--color-生活居家",
      "餐廚用品": "--color-餐廚用品"
    };

    const categories = [
      { name: "吉伊", match: row => row[1]?.v?.includes("吉") },
      { name: "小八", match: row => row[1]?.v?.includes("八") },
      { name: "兔兔", match: row => row[1]?.v?.includes("兔") },
      { name: "小桃", match: row => row[1]?.v?.includes("桃") },
      { name: "師傅", match: row => row[1]?.v?.includes("獺") },
      { name: "栗子", match: row => row[1]?.v?.includes("栗") },
      { name: "獅薩", match: row => row[1]?.v?.includes("獅") },
      { name: "古本", match: row => row[1]?.v?.includes("古") },
      { name: "其他角色", match: row => row[1]?.v?.includes("其") },
      { name: "仙境", match: row => row[0]?.v?.includes("仙境") },
      { name: "貼紙膠帶", match: row => row[2]?.v?.includes("貼紙") },
      { name: "文具磁鐵", match: row => /(文具|磁鐵)/.test(row[2]?.v) },
      { name: "立牌徽章", match: row => /(立牌|徽章)/.test(row[2]?.v) },
      { name: "鑰匙圈御守", match: row => /(鑰匙圈|御守)/.test(row[2]?.v) },
      { name: "玩具盲抽", match: row => /(玩具|盲)/.test(row[2]?.v) },
      { name: "服飾包袋", match: row => /(包包|衣服|飾品)/.test(row[2]?.v) },
      { name: "生活居家", match: row => /(3C|居家|毛巾)/.test(row[2]?.v) },
      { name: "餐廚用品", match: row => row[2]?.v?.includes("餐廚") }
    ];

    fetch(SHEET_URL)
      .then(res => res.text())
      .then(text => JSON.parse(text.substr(47).slice(0, -2)))
      .then(json => {
        const rows = json.table.rows.slice(1); // 跳過第一列
        const content = document.getElementById("content");

        categories.forEach(cat => {
          const items = rows.filter(cat.match);
          if (items.length > 0) {
            document.documentElement.style.setProperty('--role-color', `var(${colors[cat.name]})`);

            const divider = document.createElement("div");
            divider.className = "divider";
            divider.innerHTML = `<span>${cat.name}</span>`;
            content.appendChild(divider);

            const cards = document.createElement("div");
            cards.className = "cards";

            items.forEach(row => {
              const imgUrl = row[3]?.v || "https://i.postimg.cc/bv5xRs04/image.png";
              const name = row[1]?.v || "";
              const price = row[4]?.v || "";
              const stock = row[5]?.v || "";

              const card = document.createElement("div");
              card.className = "card";
              card.style.borderColor = `var(${colors[cat.name]})`;
              card.innerHTML = `
                <img src="${imgUrl}" alt="${name}">
                <div class="name">${name}</div>
                <div class="price">${price}</div>
              `;
              cards.appendChild(card);
            });

            content.appendChild(cards);
          }
        });
      })
      .catch(err => {
        console.error("載入試算表資料失敗", err);
        document.getElementById("content").innerHTML = "<p>資料載入失敗，請稍後再試。</p>";
      });
  </script>
</body>
</html>
