<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>JIWUå‰ç‰©å¯¶å¯¶ç›®éŒ„</title>
  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />
  <style>
    :root {
      --color-å‰ä¼Š: #d77485;
      --color-å°å…«: #6293b8;
      --color-å…”å…”: #f9be3c;
      --color-å°æ¡ƒ: #838BC2;
      --color-å¸«å‚…: #CCAFA5;
      --color-æ —å­: #94C973;
      --color-ç…è–©: #FBAA60;
      --color-å¤æœ¬: #eb9e97;
      --color-å…¶ä»–è§’è‰²: #45818e;
      --color-è²¼ç´™è† å¸¶: #F8C0C8;
      --color-æ–‡å…·ç£éµ: #BAD3E4;
      --color-ç«‹ç‰Œå¾½ç« : #d5a6bd;
      --color-é‘°åŒ™åœˆå¾¡å®ˆ: #7E9DC2;
      --color-ç©å…·ç›²æŠ½: #90ADC6;
      --color-æœé£¾åŒ…è¢‹: #b4a7d6;
      --color-ç”Ÿæ´»å±…å®¶: #98D7C2;
      --color-é¤å»šç”¨å“: #F1A17E;
      --color-ä»™å¢ƒ: #985859;
      --color-ãƒŠã‚¬ãƒ: #68aad6;
      --color-å°ç™½è™é»‘è™è¦: #4f5474;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
    }

    /* ğŸ”¥ é ‚éƒ¨å…¬å‘Šå€ */
    .top-bar {
      width: 100%;
      background-color: var(--role-color, #dac7b7);
      color: #fff;
      text-align: center;
      padding: 12px 0;
      position: sticky;
      top: 0;
      z-index: 999;
      font-size: 18px;
      font-weight: bold;
      animation: bounce 1.5s infinite;
    }
    .top-bar a {
      color: #fff;
      text-decoration: none;
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    /* ğŸ”¥ åˆ†é¡åˆ†éš”ç·š */
    .divider {
      display: flex;
      align-items: center;
      margin: 20px 0 10px;
    }
    .divider::before,
    .divider::after {
      content: "";
      flex: 1;
      border-top: 1px solid #999;
    }
    .divider span {
      margin: 0 10px;
      font-weight: bold;
      font-size: 18px;
    }

    /* ğŸ”¥ å•†å“å¡å®¹å™¨ */
    .cards {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 0 10px;
    }

    /* ğŸ”¥ å–®ä¸€å•†å“å¡ */
    .card {
      border: 2px solid #ccc;
      border-radius: 8px;
      width: calc(25% - 10px);
      min-width: 150px;
      background: #fff;
      box-sizing: border-box;
      text-align: center;
      transition: transform 0.3s, border-color 0.3s;
    }
    .card:hover {
      transform: scale(1.05);
    }
    .card img {
      width: 100%;
      height: auto;
      border-bottom: 1px solid #eee;
    }
    .card .name {
      font-size: 16px;
      font-weight: bold;
      margin: 5px 0;
    }
    .card .price {
      color: #666;
      margin-bottom: 8px;
    }
    .card .stock {
      font-size: 12px;
      color: #999;
      margin-bottom: 8px;
    }

    @media (max-width: 768px) {
      .card {
        width: calc(50% - 10px);
      }
    }
    @media (max-width: 480px) {
      .card {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- ğŸ”¥ é ‚éƒ¨å…¬å‘Š -->
  <div class="top-bar">
    <a href="https://lin.ee/X6FUFI9" target="_blank">è¨‚è³¼é€™é‚Šæ‰¾èŠ±èŠ± (à§¹Ë™ê’³â€‹Ë™à¸…)</a>
  </div>

  <!-- ğŸ”¥ å…§å®¹å®¹å™¨ -->
  <div id="content"></div>

  <script>
    const SHEET_ID = "1iCEqgnGGa_TVVbx90xNWxDzwKtz94VfqF8IsXRvpKMY";
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json`;

    const colors = {
      "å‰ä¼Š": "--color-å‰ä¼Š",
      "å°å…«": "--color-å°å…«",
      "å…”å…”": "--color-å…”å…”",
      "å°æ¡ƒ": "--color-å°æ¡ƒ",
      "å¸«å‚…": "--color-å¸«å‚…",
      "æ —å­": "--color-æ —å­",
      "ç…è–©": "--color-ç…è–©",
      "å¤æœ¬": "--color-å¤æœ¬",
      "å…¶ä»–è§’è‰²": "--color-å…¶ä»–è§’è‰²",
      "ä»™å¢ƒ": "--color-ä»™å¢ƒ",
      "è²¼ç´™è† å¸¶": "--color-è²¼ç´™è† å¸¶",
      "æ–‡å…·ç£éµ": "--color-æ–‡å…·ç£éµ",
      "ç«‹ç‰Œå¾½ç« ": "--color-ç«‹ç‰Œå¾½ç« ",
      "é‘°åŒ™åœˆå¾¡å®ˆ": "--color-é‘°åŒ™åœˆå¾¡å®ˆ",
      "ç©å…·ç›²æŠ½": "--color-ç©å…·ç›²æŠ½",
      "æœé£¾åŒ…è¢‹": "--color-æœé£¾åŒ…è¢‹",
      "ç”Ÿæ´»å±…å®¶": "--color-ç”Ÿæ´»å±…å®¶",
      "é¤å»šç”¨å“": "--color-é¤å»šç”¨å“"
    };

    const categories = [
      { name: "å‰ä¼Š", match: row => row[1]?.v?.includes("å‰") },
      { name: "å°å…«", match: row => row[1]?.v?.includes("å…«") },
      { name: "å…”å…”", match: row => row[1]?.v?.includes("å…”") },
      { name: "å°æ¡ƒ", match: row => row[1]?.v?.includes("æ¡ƒ") },
      { name: "å¸«å‚…", match: row => row[1]?.v?.includes("çº") },
      { name: "æ —å­", match: row => row[1]?.v?.includes("æ —") },
      { name: "ç…è–©", match: row => row[1]?.v?.includes("ç…") },
      { name: "å¤æœ¬", match: row => row[1]?.v?.includes("å¤") },
      { name: "å…¶ä»–è§’è‰²", match: row => row[1]?.v?.includes("å…¶") },
      { name: "ä»™å¢ƒ", match: row => row[0]?.v?.includes("ä»™å¢ƒ") },
      { name: "è²¼ç´™è† å¸¶", match: row => row[2]?.v?.includes("è²¼ç´™") },
      { name: "æ–‡å…·ç£éµ", match: row => /(æ–‡å…·|ç£éµ)/.test(row[2]?.v) },
      { name: "ç«‹ç‰Œå¾½ç« ", match: row => /(ç«‹ç‰Œ|å¾½ç« )/.test(row[2]?.v) },
      { name: "é‘°åŒ™åœˆå¾¡å®ˆ", match: row => /(é‘°åŒ™åœˆ|å¾¡å®ˆ)/.test(row[2]?.v) },
      { name: "ç©å…·ç›²æŠ½", match: row => /(ç©å…·|ç›²)/.test(row[2]?.v) },
      { name: "æœé£¾åŒ…è¢‹", match: row => /(åŒ…åŒ…|è¡£æœ|é£¾å“)/.test(row[2]?.v) },
      { name: "ç”Ÿæ´»å±…å®¶", match: row => /(3C|å±…å®¶|æ¯›å·¾)/.test(row[2]?.v) },
      { name: "é¤å»šç”¨å“", match: row => row[2]?.v?.includes("é¤å»š") }
    ];

    fetch(SHEET_URL)
      .then(res => res.text())
      .then(text => JSON.parse(text.substr(47).slice(0, -2)))
      .then(json => {
        const rows = json.table.rows.slice(1); // è·³éç¬¬ä¸€åˆ—
        const content = document.getElementById("content");

        categories.forEach(cat => {
          const items = rows.filter(cat.match);
          if (items.length > 0) {
            document.documentElement.style.setProperty('--role-color', `var(${colors[cat.name]})`);

            const divider = document.createElement("div");
            divider.className = "divider";
            divider.innerHTML = `<span>${cat.name}</span>`;
            content.appendChild(divider);

            const cards = document.createElement("div");
            cards.className = "cards";

            items.forEach(row => {
              const imgUrl = row[3]?.v || "https://i.postimg.cc/bv5xRs04/image.png";
              const name = row[1]?.v || "";
              const price = row[4]?.v || "";
              const stock = row[5]?.v || "";

              const card = document.createElement("div");
              card.className = "card";
              card.style.borderColor = `var(${colors[cat.name]})`;
              card.innerHTML = `
                <img src="${imgUrl}" alt="${name}">
                <div class="name">${name}</div>
                <div class="price">${price}</div>
              `;
              cards.appendChild(card);
            });

            content.appendChild(cards);
          }
        });
      })
      .catch(err => {
        console.error("è¼‰å…¥è©¦ç®—è¡¨è³‡æ–™å¤±æ•—", err);
        document.getElementById("content").innerHTML = "<p>è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>";
      });
  </script>
</body>
</html>
