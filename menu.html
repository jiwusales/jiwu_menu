<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>JIWUå¯¶å¯¶ç›®éŒ„</title>

<!-- åˆ†é å°åœ–ï¼ˆfaviconï¼‰-->
  <link rel="icon" href="https://i.postimg.cc/3R7nNT0k/icon.png" type="image/png" />
  
<style>
  /* ğŸŒŸ å…¨åŸŸè®Šæ•¸ï¼šè§’è‰²è‰² */
  :root {
    --role-color: #dac7b7;
  }

  /* ğŸŒŸ ç¶²é åŸºç¤æ¨£å¼ */
  body {
    font-family: Arial, sans-serif;
    background-color: #f9f9f9;
    background-image: url('https://i.postimg.cc/Kj8V5YMg/2.png');
    background-repeat: repeat;
    background-size: 135px;
    margin: 0;
    padding: 0;
    color: #333333;
    text-align: center;
  }

  /* ğŸŒŸ é ‚éƒ¨baræ¨£å¼ */
  .top-bar {
    background: var(--role-color);
    color: #fff;
    padding: 10px 0;
    position: sticky;
    top: 0;
    width: 100%;
    z-index: 999;
    font-weight: bold;
    user-select: none;
  }

  .top-bar a {
    color: #fff;
    text-decoration: underline;
    font-weight: bold;
    font-size: 16px;
    margin-left: 12px;
  }

  /* ğŸŒŸ å•†å“åˆ—è¡¨æ¨£å¼ */
  #product-list {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 12px;
    padding: 0 10px 20px;
    box-sizing: border-box;
    justify-items: center;
  }

  /* ğŸŒŸ åˆ†é¡åˆ†éš”ç·šæ¨£å¼ */
  .type-divider {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 20px 0 6px;
    color: #333;
    font-weight: bold;
    font-size: 14px;
    gap: 12px;
    user-select: none;
  }

  .type-divider::before,
  .type-divider::after {
    content: "";
    flex-grow: 1;
    border-top: 1px solid #333;
    min-width: 30px;
    max-width: 50%;
  }

  /* ğŸŒŸ å–®ä¸€å•†å“å¡æ¨£å¼ */
  .product {
    width: 100%;
    border: 2px solid #ccc;
    border-radius: 8px;
    background-color: #fff;
    padding: 6px 4px 8px;
    box-sizing: border-box;
    user-select: none;
    cursor: pointer;
    text-decoration: none !important;
    color: #333 !important;
    /* ğŸ›  ç§»é™¤ hover é‚Šæ¡†åŠ ç²— */
    transition: none;
  }

  /* ğŸŒŸ å•†å“åœ–ç‰‡æ¨£å¼ */
  .product img {
    width: 100%;
    height: auto;
    object-fit: contain;
    margin-bottom: 4px;
  }

  /* ğŸŒŸ è²¨æ³æ¨™ç±¤æ¨£å¼ */
  .status {
    font-size: 10px;
    padding: 2px 12px;
    border-radius: 999px;
    margin-bottom: 4px;
    display: inline-block;
    user-select: none;
    white-space: nowrap;
  }
  .status.instock { background-color: #FFF4BD; color: #333333; }
  .status.preorder { background-color: #D4BBDD; color: #333333; }
  .status.made { background-color: #74BDCB; color: #ffffff; }
  .status.flight { background-color: #5885AF; color: #ffffff; }
  .status.checking { background-color: #E7F2F8; color: #333333; }

  /* ğŸŒŸ å•†å“åç¨±èˆ‡å”®åƒ¹ */
  .name, .price {
    font-size: 12px;
    height: 24px;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    line-height: 1.2;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #333;
  }

  .name {
    font-weight: bold;
  }

  /* ğŸŒŸ åº•éƒ¨å›ºå®š bar æ¨£å¼ */
  .bottom-bar {
    background-color: var(--role-color);
    color: #fff;
    text-align: center;
    padding: 10px 0;
    font-weight: bold;
    font-size: 14px;
    margin-top: 30px;
    user-select: none;
  }

  .bottom-bar a {
    color: #fff;
    text-decoration: underline;
  }

  .center-divider {
    width: 90vw;
    max-width: 1200px;
    border-top: 1px solid #333;
    margin: 10px auto 0;
    user-select: none;
  }

  /* ğŸŒŸ æ‰‹æ©Ÿç‰ˆæ¨£å¼ */
  @media (max-width: 767px) {
    #product-list {
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      padding: 12px 10px 20px;
    }

    .product {
      max-width: 82px;
      padding: 4px 2px 6px;
    }

    .product img {
      width: 80px;
    }

    .name, .price {
      font-size: 10px;
    }
  }

  /* ğŸŒŸ æ·±è‰²æ¨¡å¼ */
  @media (prefers-color-scheme: dark) {
    body {
      background-color: #222;
      color: #eee;
    }

    .product {
      background-color: #fff;
      color: #333;
    }

    .name, .price {
      color: #333;
    }
  }
  .category-block {
  width: 100%;
  margin-bottom: 20px;
}

.product-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 12px;
  justify-items: center;
}
</style>
</head>
<body>
  
  <!-- ğŸŒŸ é ‚éƒ¨é€£çµæ¬„ -->
    <header class="top-bar" id="header-text">
    <a href="https://lin.ee/X6FUFI9" target="_blank" rel="noopener">è¨‚è³¼é€™é‚Šæ‰¾èŠ±èŠ± (à§¹Ë™ê’³Ë™à¸…) </a>
    </header>
  
  <!-- ğŸŒŸ å•†å“åˆ—è¡¨ä¸»å®¹å™¨ -->
  <main id="product-list">è¼‰å…¥ä¸­...</main>

<script>
  /* ğŸŒŸ è§’è‰²é…ç½®ï¼šå®šç¾©è§’è‰²è‰²èˆ‡é—œéµå­— */
  const roleConfig = {
    "å‰ä¼Š": { field: "è§’è‰²", keywords: ["å‰"], color: "#d77485" },
    "å°å…«": { field: "è§’è‰²", keywords: ["å…«"], color: "#6293b8" },
    "å…”å…”": { field: "è§’è‰²", keywords: ["å…”"], color: "#f9be3c" },
    "å°æ¡ƒ": { field: "è§’è‰²", keywords: ["æ¡ƒ"], color: "#838BC2" },
    "å¸«å‚…": { field: "è§’è‰²", keywords: ["çº"], color: "#CCAFA5" },
    "æ —å­": { field: "è§’è‰²", keywords: ["æ —"], color: "#94C973" },
    "ç…è–©": { field: "è§’è‰²", keywords: ["ç…"], color: "#FBAA60" },
    "å¤æœ¬": { field: "è§’è‰²", keywords: ["å¤"], color: "#eb9e97" },
    "å…¶ä»–è§’è‰²": { field: "è§’è‰²", keywords: ["å…¶"], color: "#45818e" },
    "ä»™å¢ƒ": { field: "åç¨±", keywords: ["ä»™å¢ƒ"], color: "#985859" },
    "è²¼ç´™è† å¸¶": { field: "ç¨®é¡", keywords: ["è²¼ç´™"], color: "#F8C0C8" },
    "æ–‡å…·ç£éµ": { field: "ç¨®é¡", keywords: ["æ–‡å…·", "ç£éµ"], color: "#BAD3E4" },
    "ç«‹ç‰Œå¾½ç« ": { field: "ç¨®é¡", keywords: ["ç«‹ç‰Œ", "å¾½ç« "], color: "#d5a6bd" },
    "é‘°åŒ™åœˆå¾¡å®ˆ": { field: "ç¨®é¡", keywords: ["é‘°åŒ™åœˆ", "å¾¡å®ˆ"], color: "#7E9DC2" },
    "ç©å…·ç›²æŠ½": { field: "ç¨®é¡", keywords: ["ç©å…·", "ç›²"], color: "#90ADC6" },
    "æœé£¾åŒ…è¢‹": { field: "ç¨®é¡", keywords: ["åŒ…åŒ…", "è¡£æœ", "é£¾å“"], color: "#b4a7d6" },
    "ç”Ÿæ´»å±…å®¶": { field: "ç¨®é¡", keywords: ["3C", "å±…å®¶", "æ¯›å·¾"], color: "#98D7C2" },
    "é¤å»šç”¨å“": { field: "ç¨®é¡", keywords: ["é¤å»š"], color: "#F1A17E" },
    "å°ç™½è™é»‘è™è¦": { field: null, keywords: [], color: "#4f5474" },
    "ãƒŠã‚¬ãƒ": { field: null, keywords: [], color: "#68aad6" },
    "ã‚«ãƒŠãƒ˜ãƒ©": { field: null, keywords: [], color: "#a58b7e" }
  };

  /* ğŸŒŸ åˆ†é¡é †åºé…ç½® */
  const categoryOrder = [
    { label: "åŠå¨ƒã€å¨ƒ", keywords: ["åŠå¨ƒ", "å¨ƒ"] },
    { label: "åŒ…åŒ…", keywords: ["åŒ…"] },
    { label: "é‘°åŒ™åœˆã€å¾¡å®ˆ", keywords: ["é‘°åŒ™åœˆ", "å¾¡å®ˆ"] },
    { label: "ç«‹ç‰Œã€å¾½ç« ã€ç£éµã€ç©å…·", keywords: ["ç«‹ç‰Œ", "å¾½ç« ", "ç£éµ", "ç©å…·"] },
    { label: "æ–‡å…·ã€è²¼ç´™", keywords: ["æ–‡å…·", "è²¼ç´™"] },
    { label: "3Cã€å±…å®¶ã€æ¯›å·¾", keywords: ["3C", "å±…å®¶", "æ¯›å·¾"] },
    { label: "é£¾å“ã€è¡£æœ", keywords: ["é£¾å“", "è¡£æœ"] },
    { label: "é¤å»š", keywords: ["é¤å»š"] }
  ];

  /* ğŸŒŸ Google Sheets API è¨­å®š */
  const spreadsheetId = "1iCEqgnGGa_TVVbx90xNWxDzwKtz94VfqF8IsXRvpKMY";

  const sheetURLs = {
    "å‰ä¼Š": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å°å…«": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å…”å…”": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å°æ¡ƒ": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å¸«å‚…": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "æ —å­": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "ç…è–©": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å¤æœ¬": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å…¶ä»–è§’è‰²": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "ä»™å¢ƒ": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "è²¼ç´™è† å¸¶": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "æ–‡å…·ç£éµ": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "ç«‹ç‰Œå¾½ç« ": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "é‘°åŒ™åœˆå¾¡å®ˆ": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "ç©å…·ç›²æŠ½": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "æœé£¾åŒ…è¢‹": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "ç”Ÿæ´»å±…å®¶": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "é¤å»šç”¨å“": `https://opensheet.elk.sh/${spreadsheetId}/ã¡ã„ã‹ã‚`,
    "å°ç™½è™é»‘è™è¦": `https://opensheet.elk.sh/${spreadsheetId}/å°ç™½è™é»‘è™è¦`,
    "ãƒŠã‚¬ãƒ": `https://opensheet.elk.sh/${spreadsheetId}/ãƒŠã‚¬ãƒ`,
    "ã‚«ãƒŠãƒ˜ãƒ©": `https://opensheet.elk.sh/${spreadsheetId}/ã‚«ãƒŠãƒ˜ãƒ©`
  };

  /* ğŸŒŸ Google Sheets API è¨­å®š */
  const roleParam = new URLSearchParams(location.search).get("role") || "å‰ä¼Š";
  const config = roleConfig[roleParam] || { field: null, keywords: [], color: "#ccc" };
  const sheetURL = sheetURLs[roleParam] || sheetURLs["å‰ä¼Š"];

document.documentElement.style.setProperty('--role-color', config.color);

  document.documentElement.style.setProperty('--role-color', config.color);

  const container = document.getElementById("product-list");
container.innerHTML = "è¼‰å…¥ä¸­...";

  /* ğŸŒŸ è¼‰å…¥è³‡æ–™ä¸¦åˆ†é¡æ¸²æŸ“å•†å“ */
  fetch(sheetURL)
  .then(res => {
    if (!res.ok) throw new Error("HTTP error " + res.status);
    return res.json();
  })
  .then(data => {
  console.log("Raw data:", data);

  const filtered = data.filter(row => {
    if (row["ä¸Šæ¶"] === "x") return false;
    // ä¿®æ”¹åˆ¤æ–·ï¼šå¦‚æœ config.field ä¸å­˜åœ¨æˆ–é—œéµå­—æ˜¯ç©ºçš„ï¼Œå…¨éƒ¨æ”¾è¡Œ
    if (!config.field || config.keywords.length === 0) return true;
    // æœ‰è¨­å®šæ¢ä»¶æ‰æ¯”å°
    return config.keywords.some(k => (row[config.field] || "").includes(k));
  });

  console.log("Filtered data:", filtered);

  if (filtered.length === 0) {
    container.innerHTML = "æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„å•†å“";
    return;
  }

    const categorizedProducts = {};
    categoryOrder.forEach(cat => categorizedProducts[cat.label] = []);

    filtered.forEach(p => {
      for (let cat of categoryOrder) {
        if (cat.keywords.some(k => (p["ç¨®é¡"] || "").includes(k))) {
          categorizedProducts[cat.label].push(p);
          break;
        }
      }
    });

    container.innerHTML = "";

    categoryOrder.forEach(cat => {
      const items = categorizedProducts[cat.label];
      if (items.length === 0) return;

      const categoryBlock = document.createElement("div");
      categoryBlock.className = "category-block";

      const divider = document.createElement("div");
      divider.className = "type-divider";
      divider.textContent = cat.label;
      categoryBlock.appendChild(divider);

      const productGrid = document.createElement("div");
      productGrid.className = "product-grid";

      items.forEach(p => {
        let status = "";
        let statusClass = "";

        if (sheetURL.includes("/ã¡ã„ã‹ã‚")) {
          if ((p["å—æ³¨"] || "").toLowerCase().includes("v")) {
            status = "å—æ³¨å“"; statusClass = "made";
          } else if (parseInt(p["åº«å­˜"]) > 0) {
            status = "ç¾è²¨"; statusClass = "instock";
          } else if (p["åº«å­˜"] === "0" && !p["éç¾"]) {
            status = "éœ€é è¨‚"; statusClass = "preorder";
          } else if (p["åº«å­˜"] === "0" && p["éç¾"]) {
            status = "æ­é£›æ©Ÿä¸­"; statusClass = "flight";
          } else {
            status = "é»è²¨ä¸­"; statusClass = "checking";
          }
        }

        let price = "";
        let linkUrl = "https://lin.ee/X6FUFI9";

        if (p["å”®åƒ¹"] === "-") {
          price = "çµ„åˆå‡ºå”®";
          linkUrl += `?text=çµ„åˆå‡ºå”®%20${encodeURIComponent(p["åç¨±"])}`;
        } else if (!p["å”®åƒ¹"]) {
          price = "ç§è¨ŠèŠ±èŠ±";
          linkUrl += `?text=ç§è¨ŠèŠ±èŠ±%20${encodeURIComponent(p["åç¨±"])}`;
        } else {
          price = p["å”®åƒ¹"];
          linkUrl = null;
        }

        let imageUrl = p["åœ–ç‰‡"]?.trim() || "https://i.postimg.cc/XJSn6Jx1/image.png";

        const product = document.createElement(linkUrl ? "a" : "div");
        product.className = "product";
        if (linkUrl) {
          product.href = linkUrl;
          product.target = "_blank";
          product.rel = "noopener";
        }

        product.innerHTML = `
          <img src="${imageUrl}" alt="">
          ${status ? `<div class="status ${statusClass}">${status}</div>` : ""}
          <div class="name" title="${p["åç¨±"]}">${p["åç¨±"]}</div>
          <div class="price">${price}</div>
        `;
        productGrid.appendChild(product);
      });

      categoryBlock.appendChild(productGrid);
      container.appendChild(categoryBlock);
    });
  })
  .catch(err => {
    container.innerHTML = "è¼‰å…¥è³‡æ–™å¤±æ•—";
    console.error(err);
  });
</script>
</body>
</html>
